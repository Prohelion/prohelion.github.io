

<!DOCTYPE html>

	<html lang="en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, minimum-scale=1.0">
		
			<title>Contactor and Precharge | Prohelion</title>
		
		
		
			<meta name="keywords" content="BMS,">
		
		<link rel="icon" href="/favicon.ico" type="image/x-icon">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono|IBM+Plex+Sans:400,400i,500,500i,700,700i">
		<link rel="stylesheet" href="/dox-theme/assets/css/style.css">
	</head>
	<body>
		
			<div class="c-offcanvas">
				<div class="c-offcanvas__inner">
					
						<ul class="c-nav c-nav--stacked u-mx-auto">
							
								<li><a href="/Doc/https://www.prohelion.com">Prohelion Website</a></li>
							
						</ul><!-- /.c-nav -->
					
					
						
							<a href="/" class="c-btn c-btn--md c-btn--gray u-text-md">
								Documentation Homepage
								<div class="c-btn__icon">
									<i class="o-icon o-icon--book"></i>
								</div>
							</a>
						
					
				</div><!-- /.c-offcanvas__inner -->
			</div><!-- /.c-offcanvas -->
		

		
			<header class="c-header u-text-white">
				<div class="o-container">
					<div class="o-row">
						<div class="o-col-12">
							<div class="u-flex u-items-center">
								
									<div class="c-logo">
										<a href="/Doc//" class="c-logo__link">
											<img src="/Doc//dox-theme/assets/images/layout/logo.png">
										</a><!-- /.c-logo__link -->
									</div><!-- /.c-logo -->
								
								
									<div class="u-flex u-items-center u-ml-auto">
										
											<ul class="c-nav u-mb-0 u-hidden u-block@lg">
												
													
													<li class=""><a href="/Doc/https://www.prohelion.com">Prohelion Website</a></li>
												
											</ul><!-- /.c-nav -->
										
										
											<div class="u-ml-5 u-hidden u-block@lg">
												
													<a href="/" class="c-btn c-btn--md c-btn--white u-text-md">
														Documentation Homepage
														<div class="c-btn__icon">
															<i class="o-icon o-icon--book"></i>
														</div>
													</a>
												
											</div>
										
									</div>
								
								<button class="c-hamburger-icon c-hamburger-icon--slider c-hamburger-icon--white js-hamburger-icon js-offcanvas-toggle u-ml-auto u-hidden@lg" type="button">
									<span class="c-hamburger-icon__box">
										<span class="c-hamburger-icon__inner"></span>
									</span><!-- /.c-hamburger-icon__box -->
								</button><!-- /.c-hamburger-icon -->
							</div>
						</div><!-- /.o-col -->
					</div><!-- /.o-row -->
				</div><!-- /.o-container -->
			</header><!-- /.c-header -->
		










	<div class="u-pt-8 u-pb-5">
		<div class="o-container">
			<div class="o-row">
				
					<div class="o-col-8@lg o-col-7@xl">
						<div class="c-post u-mb-3@lg js-post">
							<h2 id="pack-current-sense">PACK CURRENT SENSE</h2>
<p>The BMU provides a mechanism for measuring pack current using a resistive shunt.  This is preferred over hall-effect based sensors as it provides much lower drift, allowing more accurate State of Charge (SOC) integration calculation.</p>

<p>The shunt must be located in the Battery HV– connection of the pack, as shown in the BMS wiring diagram in the Appendix.</p>

<h3 id="shunt-selection">SHUNT SELECTION</h3>
<p>The BMU Shunt Sense input has a full-scale range of ±25mV, relative to the Battery HV– Sense input.  This allows the use of a standard 50mV shunt running at half its rated current to minimise heat buildup and thermal drift effects, since it will be installed inside the battery pack.</p>

<p>Choose a full-scale range slightly over the expected maximum battery current. As an example, a Tritium WaveSculptor200 motor controller driving an induction motor may have an expected maximum power consumption of 90kW.  At a 400V battery voltage, this is 225A.  Choose a full scale of 250A to allow some headroom on the measurement.  Since we wish to use a standard 50mV shunt at half rating, you would therefore select a 500A/50mV shunt. The value of the shunt can be set in the user-interface software.</p>

<h3 id="state-of-charge-reporting">STATE OF CHARGE REPORTING</h3>
<p>The BMU takes readings of the shunt current using a high-accuracy front-end circuit and 24-bit A/D converter.  It integrates these readings to accumulate an Ah consumption for the pack.</p>

<p>The Ah accumulation is used in conjunction with the user-settable pack capacity value to calculate a SOC in percent.  Both Ah and percent are reported on the CAN bus.</p>

<p>The SOC reading is reset to ‘full’ when the first bypass shunt has activated during a charge cycle.  At this point the “Balance SOC” telemetry value begins incrementing, halting when all bypass shunts are active.  This “Balance SOC” telemetry value therefore shows the amount of imbalance between cells that has been corrected during the current charging session.</p>

<h3 id="overcurrent-shutdown">OVERCURRENT SHUTDOWN</h3>
<p>The BMU has the capability to shut down the pack by opening the contactors if the pack current exceeds a fixed threshold.  This function is not currently implemented in the default firmware, but will be added at a later date.</p>

<h2 id="contactor-drive--sense">CONTACTOR DRIVE / SENSE</h2>
<p>The BMU provides three outputs for driving HV contactors with 12V coils.  At a minimum Contactors 1 &amp; 2 are required for pack safety, although this option still presents a shock hazard (via the precharge resistor) in a single-fault situation to the rest of the system.  A professional design will use all three contactors.</p>

<p>The contactors are energised in sequence (1, 3, 2) during precharge, and deenergised when shutting down the system both under user command and due to a fault being detected by the BMS.  The BMU operates the contactors to protect the cells above all other priorities.</p>

<p>Each contactor output connector also has pins for feedback from contactors with auxilliary sense contacts.  These can be used by the BMU to detect failed contactors, both failed open or welded shut.  Do not connect these pins to anything other than auxilliary contact output terminals – they are not rated for anything more than the 12V supplied by the BMU.</p>

<p>Refer to the BMS datasheet for continuous and peak current and voltage ratings of the contactor drive outputs.  Contactors without integrated electronics must have a diode fitted across their coil terminals to limit flyback voltage at turn-off.</p>

<h3 id="contactor-12v-supply-connector">CONTACTOR 12V SUPPLY CONNECTOR</h3>
<p>The connector used for the Contactor 12V supply input is a 2-way 4.2mm pitch Molex MiniFit Jr connector.  The pinout is shown below, as viewed from the wire side – as you would look at it while inserting crimps.</p>

<p><img src="/images/IMPS_BMS_Contactor_Connector.gif" alt="BMS Contactor Connector" /></p>

<p>This connection should be wired to the vehicle 12V DC supply via the emergency stop switch (if fitted), the G-force impact switch, an optional HV disable switch, and a fuse.  It requires a low impedance connection to the vehicle battery, since most contactors draw a large current inrush during turn-on, and a poor connection will result in contactor chattering and/or precharge fault trips.</p>

<p>This connection draws no current when the BMS is in the off state, and does not have to be routed via the ignition key.  Connecting it to a permanent source of power (rather than via the ignition key) allows the BMS to operate the contactors without the ignition key switched on, for example during charging.</p>

<h3 id="contactor-output-connectors">CONTACTOR OUTPUT CONNECTORS</h3>
<p>The connectors used for the Contactor drive outputs are a 4-way 4.2mm pitch Molex MiniFit Jr connector.  The pinout is shown below, as viewed from the wire side – as you would look at it while inserting crimps. The colours shown match those used by the Gigavac GX11 and GX12 family of contactors.</p>

<p><img src="/images/IMPS_BMS_Contactor_Output.gif" alt="BMS Contactor Output" /></p>

<h2 id="precharge">PRECHARGE</h2>
<h3 id="concept">CONCEPT</h3>
<p>Loads such as motor controllers (inverters), DC/DC converters, and other highvoltage, high-power electronics contain capacitors across the DC bus.  If these are suddenly connected to the battery pack by closing a contactor or switch, then there will be a very large inrush current (thousands of Amps) followed by a voltage surge due to the battery and cabling inductance.  This inrush current will damage the devices and weld contacts together, and the voltage surge can also cause components to fail.</p>

<p>Precharging the capacitors in the various devices solves these problems.  This can be done by first connecting the loads to the battery through a resistor, so that the current into the capacitors is limited to a few amps.  The voltage on the capacitors will then rise in a controlled manner, and when it is close to the battery voltage the main contactor can be closed to directly connect everything together.</p>

<h3 id="action">ACTION</h3>
<p>The BMU initiates a precharge sequence when commanded to do so from the EV Driver Controls.  There are two conditions that begin precharge: the ignition key moving to the start position from the run position; and the fuel door being opened for charging.</p>

<p>Either closing the fuel door, or moving the key to no longer be in Ignition run position will shut down the system and open the contactors to make the system safe.</p>

<p>The BMU can also be set to run in “Standalone Operation” mode, where it will precharge as soon as it measures an acceptable voltage on the 12V contactor power input.  This mode would normally be used in remote area power installations and similar applications, not in vehicles.</p>

<h3 id="sequence">SEQUENCE</h3>
<p>The precharge sequence is as follows:</p>

<ol>
  <li>
    <p>Contactor 1 energises to connect Pack- to the vehicle</p>
  </li>
  <li>
    <p>Contactor 3 energises to connect Pack+ to the precharge resistor, and allow the BMU to take pack voltage measurements. A pack isolation test is performed at this point</p>
  </li>
  <li>
    <p>The capacitors in the devices in the vehicle precharge through the</p>
  </li>
</ol>

<p>precharge resistor that is in parallel with Contactor 2</p>

<ol>
  <li>
    <p>When the pack voltage and the DC bus voltage are within tolerance then Contactor 2 is energised to complete the high-current circuit</p>
  </li>
  <li>
    <p>The BMU is now in “Run” mode, and does the following:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>•       reports this fact on the CAN bus

•       activates the status relay output (which can be used to enable the DC/DC converter)

•       turns on the pack fan outputs
</code></pre></div></div>

<h3 id="precharge-resistor-selection">PRECHARGE RESISTOR SELECTION</h3>
<p>Selection of the external precharge resistor is critical for correct and long-term reliable operation of the precharge circuit.  A judgement must be made by the designer of the vehicle power system to the tradeoff between resistor size, cost and weight, and expected precharge time.  A slower time can use a smaller, cheaper resistor, but taking too long to precharge will be annoying to the end user of the vehicle.  An aluminium-cased wirewound resistor is the most commonly chosen type of resistor.</p>

<p>As an example, the calculations for a typical EV system are shown as follows:</p>

<p>System battery voltage maximum = <strong>450V</strong></p>

<p>Motor controller (Tritium Wavesculptor 200) capacitance = <strong>800µF</strong></p>

<p>Chosen precharge current = <strong>1A</strong></p>

<p>Therefore, the minimum resistance (fastest precharge) will be 450V / 1A = 450 Ohms.  Choose 470 Ohms as the next highest common value.  Peak power dissipation in the resistor is therefore 450V²/470R = <strong>430W</strong></p>

<p>The expected precharge time is given by the time constant TAU = R (Ohms) * C (Farads), where the voltage on the capacitor should change by 63% of the difference each TAU time interval.  Precharge should be within 95% of the initial value within 4 TAU, and to 99% within 5 TAU intervals, as an exponential decay. For the example system, TAU = 376ms, so the expected precharge time of 4 TAU = <strong>1.5 seconds</strong></p>

<p>Choosing a &gt;500W resistor is unnecessary, as this rating is only needed for a short amount of time during normal operation.  However, the resistor cannot be too small, as if a fault situation occurs, such as a short circuit in the motor controller, then this power will be dissipated continuously for the entire expected precharge time, until the precharge controller realises that precharging has not occurred properly and goes into an error state.  For safety, the resistor in the example system should be chosen to tolerate a one-off event, starting at the expected maximum ambient temperature, of 430W for 1.5 seconds.</p>

<p>Searching through available off-the-shelf options from Digikey, the RH series from Vishay is chosen as a likely candidate.  According to the datasheet located at http://www.vishay.com/docs/50013/rh.pdf , for short time overloads, a power rating of 12x the nominal power is acceptable for a 2 second duration.  Using a 50W resistor, this equates to an overload rating of 600W, starting at an ambient of 25°C.</p>

<p>Therefore, this 50W resistor is acceptable for the external resistor in this application based on maximum fault power.</p>

<p>During normal operation, the capacitors contain a charge of 0.36C, giving an energy storage of <strong>81 Joules</strong>.  Note that this is a lethal amount of energy.  During an RC precharge type event, the same amount of energy that is eventually stored in the capacitor is also dissipated in the resistor.</p>

<p>If not mounted on any additional thermal mass, and assuming that 20g of the resistor’s total mass is aluminium (specific heat = 0.897 J/g°C), 81 Joules will give a temperature rise of ∆T = Q/mc = <strong>4.5°C</strong>, also well within limits.  During a fault situation, where 430W is being dissipated in the resistor, the same thermal calculation shows a temperature rise of 48°C above the starting temperature. This also is within limits.</p>

<p>The maximum acceptable operating voltage for the 50W resistor is 1285V, so our maximum of 450V is also within limits.</p>

<p>Therefore, a <strong>470 ohm, 50W, RH series wirewound aluminium resistor</strong> would be a suitable choice of external resistor for this application of precharging <strong>800uF to 450V in 1.5 seconds</strong>.  Other devices on the HV bus such as DC/DC converters and battery chargers will add significant extra capacitance, and must be factored into these calculations.</p>

<p>Note that the BMS must be programmed with the correct timeout value, so as it knows what the expected precharge time is.  If this is not done, then the precharge controller will either expect precharge to have finished when it has not, resulting in an error state, or it will expect precharge to take much longer than it really does, resulting in a potential overload and a fire in the external resistor if there is a system fault.</p>

<h3 id="caveats">CAVEATS</h3>
<p>Be aware that loads that draw current during precharge will cause the precharge sequence to fail and/or the precharge resistor to overheat.  This is because the current drawn by the load will slow or possibly prevent the output voltage from rising, meaning precharge never completes in the expected time.</p>

<p>The typical load that causes this problem is the DC/DC converter used to charge the 12V auxilliary battery.</p>

<p>This problem can be avoided by using the relay output on the BMU to control an “enable” input on the problematic loads once precharge has completed and the BMU is in “Run” mode.  By default, this relay activates in this manner.</p>

<h2 id="trusted-measurements">TRUSTED MEASUREMENTS</h2>
<p>The CMUs measure their cell voltages using two separate front-end circuits, A/D converters, and voltage references.  One channel records with a high resolution 24-bit converter at a slow 2 Hz rate.  The other channel uses a mid resolution 12bit converter running at several kHz.  These are cross-checked against each other to verify that the CMU is functioning correctly and that the cell voltage measurement can be trusted.</p>

<p>Measurements reported on the CAN bus telemetry come from the high resolution channel.</p>

<p>Measurements where the two channels do not agree are flagged as untrusted.  If any cells report an untrusted measurement, the BMU will report a TRUST error on the CAN bus.  This is not treated as a fatal error, and will not result in a pack shutdown.</p>

<p>The threshold where a trust error is generated is set in the BMU config, and is currently factory set to 100mV.</p>

<p>Please note that due to the different response rates of the two A/D converters, it is possible to get a trust error briefly during sharp voltage transients on the cells, for instance during rapid acceleration or regen braking events.  Whatever higherlevel vehicle system is handling BMS telemetry and user interface should be programmed to ignore trust errors that are present for less than some period (eg 500ms) of time.</p>

<h2 id="fusing">FUSING</h2>
<p>The battery pack must be fused in each physical pack section with a fuse rated for at least the full DC pack voltage.  Note that it must be a DC rated fuse.</p>

<p>Selection of fuse type and current rating is beyond the scope of this document, as it depends on expected load profile and duration, cable sizing and temperature rating, cable installation methods, and short-circuit rating of the pack, among other factors.</p>

<h2 id="contactor-selection">CONTACTOR SELECTION</h2>
<p>The three contactors used to break the HV DC connections must be appropriately rated for the currents and voltages seen during both normal use and during fault situations.  Typical parts used in automotive sized packs are the Tyco EV200 or the Gigavac GX11 or GX12 series.  Selection of these parts is beyond the scope of this document.</p>


							
							
						</div><!-- /.c-post -->
					</div><!-- /.o-col -->
								
				
					<div class="o-col-3@lg o-offset-1@lg o-offset-2@xl">
						<ul class="c-page-nav u-sticky u-pin-t-6 u-mt-4 u-mt-1@lg u-mb-1 u-mb-4@lg">
														
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
								
							
								
									
										
											<li class="is-active">
												<a href="/Battery_Management_System/Overview.html">
													<p class="c-page-nav__heading">BMS Overview</p>
												</a>
											</li>
										
									
								
							
								
									
								
							
								
									
								
							
								
									
										
											<li class="is-active">
												<a href="/Battery_Management_System/CMU_Overview.html">
													<p class="c-page-nav__heading">CMU Overview</p>
												</a>
											</li>
										
									
								
							
								
									
								
							
								
									
										
											<li class="is-active">
												<a href="/Battery_Management_System/Contactor_Precharge.html">
													<p class="c-page-nav__heading">Contactor and Precharge</p>
												</a>
											</li>
										
									
								
							
								
									
										
											<li>
												<a href="/Battery_Management_System/Operating_Thresholds_State.html">
													<p class="c-page-nav__heading">Operating Thresholds and State</p>
												</a>
											</li>
										
									
								
							
								
									
										
											<li>
												<a href="/Battery_Management_System/Inputs_Outputs_Controls.html">
													<p class="c-page-nav__heading">Inputs, Outputs and Controls</p>
												</a>
											</li>
										
									
								
							
								
									
										
											<li>
												<a href="/Battery_Management_System/BMS_Telemetry_Viewing_Software.html">
													<p class="c-page-nav__heading">BMS Telemetry Viewing Software</p>
												</a>
											</li>
										
									
								
							
								
									
										
											<li>
												<a href="/Battery_Management_System/CMU_Cell_Wiring_Procedure.html">
													<p class="c-page-nav__heading">CMU Cell Wiring Procedure</p>
												</a>
											</li>
										
									
								
							
								
									
										
											<li>
												<a href="/Battery_Management_System/BMU_Communications_Protocol.html">
													<p class="c-page-nav__heading">BMU Communications Protocol</p>
												</a>
											</li>
										
									
								
							
						</ul><!-- /.c-page-nav -->
					</div><!-- /.o-col -->
				
			</div><!-- /.o-row -->
		</div><!-- /.o-container -->
	</div>




	<div class="u-bg-primary u-text-white u-pt-3 u-pt-4@sm u-pb-3 u-pb-4@sm">
		<div class="o-container">
			<div class="o-row">
				<div class="o-col-12 u-text-center">
					<div class="u-inline-block u-flex@sm">
						
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
																	
															
						
							
								
									
									
									
																	
															
						
							
																	
															
						
							
																	
															
						
							
								
									
									
									
										<a href="/Battery_Management_System/CMU_Overview.html" class="c-arrow-link c-arrow-link--prev u-mr-auto">CMU Overview</a>
									
																	
															
						
							
																	
															
						
							
								
									
									
									
																	
															
						
							
								
									
									
									
										<a href="/Battery_Management_System/Operating_Thresholds_State.html" class="c-arrow-link c-arrow-link--next u-ml-auto">Operating Thresholds and State</a>
									
																	
															
						
							
								
									
									
									
																	
															
						
							
								
									
									
									
																	
															
						
							
								
									
									
									
																	
															
						
							
								
									
									
									
																	
															
						
					</div>
				</div><!-- /.o-col -->
			</div><!-- /.o-row -->
		</div><!-- /.o-container -->
	</div>




	

		
			<footer class="c-footer">
				<div class="o-container">
					<div class="o-row">
						<div class="o-col-12 u-mt-6 u-mt-8@md u-mb-4 u-mb-6@md">
							
								<p class="c-logo u-mb-1">
									Prohelion Documentation
								</p><!-- /.c-logo -->
							
							
								<p>Copyright &copy; 2020. - Prohelion Pty Ltd <br>All rights reserved.</p>
							
						</div><!-- /.o-col -->
					</div><!-- /.o-row -->
				</div><!-- /.o-container -->
			</footer><!-- /.c-footer -->
		

		<script type="text/javascript" src="/Doc//dox-theme/assets/js/vendor/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="/Doc//dox-theme/assets/js/scripts.min.js"></script>

		

	</body>
</html>


